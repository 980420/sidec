<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j">

<ui:composition>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<script type="text/javascript">setContentTitle('#{messages.titulo}')</script>
	<link rel='stylesheet'
		href='#{facesContext.externalContext.requestContextPath}/resources/modEnsayo/style/cssGenericas.css'
		type='text/css' />
	<!-- Estilo para los mensajes -->

	<style type="text/css">
.functpanelbody {
	padding: 0px;
}

.functpanelbody2 {
	padding: 5px;
}

.iconcell, .labelcell {
	padding: 0px;
	border: 1px;
}

.strech {
	width: 100%;
	padding-left: 0px !important;
	padding-top: 1px;
	padding-bottom: 1px;
}

.nostrech {
	width: 1%;
	padding-left: 0px !important;
	padding-right: 0px !important;
}

.rich-message-label {
	font-size: 10px;
	font-family: "Verdana";
}

.custom-error {
	border: 1px solid #FFCC00;
	padding: 5px;
	background-color: #F0F8FF;
	font-size: 10px;
	font-family: "Verdana";
	position: relative;
	left: 5px;
	top: 5px;
	margin-right: 10px;
}
</style>
	<script type="text/javascript">					

		//funcion para cambiar el tamano de la lista del combobox
		function cambiarStyle(id,size)
		{
		var size2=''+size+'px';
		var n=new String(id);
		var idN=n.replace('combobox','list');
		
		var com=document.getElementById(idN);
		var parent=com.parentNode;
		var gran=parent.parentNode;
		parent.style.width=size2;
		gran.style.width=size2;
		com.style.width=size2;
		
		} 

		var curDtN = new Date();
		 var calDtN=null;

		 function previousDate(date){
			calDtN = date;
		 }

		 function disablementFunction(day){
			 if(calDtN == null){
				 if (curDtN.getTime() - day.date.getTime() &#62; 0) 
						return true; 
					else 
						return false; 
			 }
			 else {
				 if (calDtN.getTime() - day.date.getTime() &#62;= 0 ) 
						return true; 
					else 
						return false;
			 }					 
		 }

		 function disabledClassesProv(day){
			 if(calDtN == null){
				 if (curDtN.getTime() - day.date.getTime() &#62; 0) 
						return ''; 
					else 
						return 'noavailable'; 
			 }
			 else {
				 if (calDtN.getTime() - day.date.getTime() &#62;= 0) 
						return ''; 
					else 
						return 'noavailable';
			 }				
		 }

		 function resetSecondDate(first,second) {
			 var firstDate = first.getSelectedDate().getTime();
			 var secondDate = second.getSelectedDate().getTime();

			 if(firstDate - secondDate &#62; 0)
				 second.resetSelectedDate();
		 }
 		 
		 function disablementFunctionPreviousEx(day){
			if(calDtN == null){
				if (curDtN.getTime() - day.date.getTime() &#62; 0) return true; else return false;
			}
			if ((curDtN.getTime() - day.date.getTime() &#62; 0) &#38;&#38; (calDtN.getTime() - day.date.getTime() &#60;= 0)){
				return true;
			}
			else 
				return false;
		  }

		function disabledClassesProvPreviousEx(day){
			if(calDtN == null){
				if (curDtN.getTime() - day.date.getTime() &#60; 0)
					return 'noavailable';
				else 
					return '';
			}
			if ((curDtN.getTime() - day.date.getTime() &#60; 0) || (calDtN.getTime() - day.date.getTime() &#62; 0))
				return 'noavailable';
			else 
				return '';
		}
	</script>




	<h:form id="busquedasForm">
		<a4j:jsFunction name="assignname" ajaxSingle="true"
			reRender="busquedas">			
			<a4j:actionparam name="provider" value="#{provider}"
				assignTo="#{statisticsReporter.providerName}" />
		</a4j:jsFunction>

		<a4j:outputPanel ajaxRendered="true">

			<s:div
				rendered="#{facesMessages.getCurrentMessagesForControl('listOfGruposujetoss').size() > 0 }"
				styleClass="custom-error">
				<div>
					<rich:message for="listOfGruposujetoss" />
				</div>
			</s:div>
		</a4j:outputPanel>

		<rich:simpleTogglePanel switchType="client" style="margin-top:5px;"
			bodyClass="simpleTogPanel">
			<f:facet name="header">
				<h:outputLabel value="#{messages.criterios}" style="cursor:pointer;" />
			</f:facet>
			<a4j:outputPanel id="busquedas">
				<ui:include src="#{search_include}" />
				<table cellpadding="0" cellspacing="0" border="0">

					<tr>
						<td colspan="5"><rich:spacer height="11px" width="100%" /></td>
					</tr>
					<tr>
						<td colspan="5" align="right"><a4j:commandButton
								reRender="listadoGruposujetos" style="margin:0px"
								value="#{messages.buscar}"
								action="#{statisticsReporter.previewReport()}" /> <rich:spacer
								width="8px" /> <h:commandButton
								action="cancelar" style="margin:0px"
								value="#{messages.cancelar}" /></td>
					</tr>
				</table>
			</a4j:outputPanel>
		</rich:simpleTogglePanel>
	</h:form>
	<script>
				assignname();
			</script>

	<rich:spacer height="11px" width="100%" />
	<a4j:region>
		<a4j:outputPanel id="listadoGruposujetos">
			<rich:panel rendered="#{statisticsReporter.results > 0}">
				<f:facet name='header'> 
              #{messages.previa}
            </f:facet>
				<iframe width="100%" height="800px"
					src="#{facesContext.externalContext.requestContextPath}#{statisticsReporter.pathExportedReport}"></iframe>
				<div align="right">
					<a4j:form>
						<a4j:commandButton
							onclick="javascript:Richfaces.showModalPanel('exportPanel')"
							action="hola" value="Exportar"></a4j:commandButton>
						<a4j:commandButton
							onclick="javascript:Richfaces.showModalPanel('printPanel')"
							action="hola" value="Imprimir"></a4j:commandButton>

					</a4j:form>
				</div>
			</rich:panel>
			<rich:panel rendered="#{statisticsReporter.results==0}">
				<f:facet name='header'> 
              #{messages.previa}
            </f:facet>
				<table class="Tabla" cellpadding="0px" cellspacing="0px">
					<tr>
						<td class="margenSupIzq"><h:outputText
								value="#{messages.sinresult}" /></td>
					</tr>
				</table>
			</rich:panel>
		</a4j:outputPanel>
	</a4j:region>
	<s:div id="modalpanelsdiv">

		<ui:include
			src="/modEnsayo/ensayo_estadisticas/codebase/comun/exportModalPanel.xhtml">
			<ui:param name="controlador" value="#{statisticsReporter}" />
		</ui:include>

		<ui:include
			src="/modEnsayo/ensayo_estadisticas/codebase/comun/printModalPanel.xhtml" />

	</s:div>

</ui:composition>

</html>