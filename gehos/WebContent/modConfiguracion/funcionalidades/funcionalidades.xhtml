<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                             "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:c="http://java.sun.com/jstl/core" template="#{theme.template}">

	<ui:define name="body">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

		<!-- Estilos generales -->
		<link
			href="#{facesContext.externalContext.requestContextPath}/modConfiguracion/management/styles/general.css"
			rel="stylesheet" type="text/css" />


		<script type="text/javascript">setContentTitle('#{messages.lbl_Configurarfuncionalidades_conf}')</script>
		<h:messages globalOnly="true" styleClass="message" />

		<rich:hotKey key="esc" handler="subir()" />

		<a:form>
			<a:jsFunction name="subir" ajaxSingle="true"
				status="funcSelectedStatus"
				reRender="settingsdiv, detailspanelheader"
				action="#{funcionalidadesManager.subir()}"></a:jsFunction>
		</a:form>


		<h:form id="funcionalidadesControllerForm3">
			<table width="100%" cellpadding="5px" cellspacing="0px"
				style="vertical-align: top;">
				<tr>

					<td style="vertical-align: top; width: 45%;"><rich:panel
							bodyClass="functpanelbody2">
							<f:facet name="header">
								<a:status stopText="#{messages.lbl_funcionalidades_conf}"
									for="functsstree"
									startText="#{messages.msg_actualizando_modConfig}"
									id="funcstatus"></a:status>
							</f:facet>
							<div style="border: 1px;">
								<a:region id="functsstree">
									<a:outputPanel ajaxRendered="true">

										<rich:dragIndicator id="treeDragIndicator">
											<f:facet name="single">
												<h:panelGrid columns="2">
													<h:graphicImage styleClass="indicatorPicture"
														value="/resources/funcionalidadesIcons/{modulename}/{iconname}" />
													<h:outputLabel value="{label}" />
												</h:panelGrid>
											</f:facet>
										</rich:dragIndicator>

										<s:div style="margin-left:2px;">
											<h:panelGrid columns="2" cellpadding="0" cellspacing="0">
												<h:graphicImage
													value="/resources/modConfiguracion/hospital-icon.png"
													height="16" />
												<a:commandLink
													action="#{funcionalidadesManager.setSelectedFunctionality(null, null)}"
													value="#{messages.lbl_funcionalidades_conf}"
													style="margin-left:1px;" status="funcSelectedStatus"
													ajaxSingle="true"
													reRender="settingsdiv, detailspanelheader" />
											</h:panelGrid>
										</s:div>

										<rich:tree
											changeExpandListener="#{funcionalidadesManager.treeBuilder.OnNodeCollapseExpand}"
											value="#{funcionalidadesManager.treeBuilder.treeData}"
											switchType="ajax" preserveModel="state"
											preserveDataInRequest="true" treeNodeVar="treenode"
											dragIndicator="treeDragIndicator" style="width:200px"
											nodeFace="#{node.toString()}" var="node" id="functree"
											dropListener="#{funcionalidadesManager.processDrop}"
											componentState="#{treeStateController.funcionalidadesTreeState}">

											<rich:treeNode type="modulo" acceptedTypes="funcionalidad"
												icon="/modCommons/modSelector/#{theme.name}/themes/#{theme.color}/images/icons/bg.png"
												iconLeaf="/modCommons/modSelector/#{theme.name}/themes/#{theme.color}/images/icons/bg.png">
												<div style="left: -20px; position: relative; top: 2px;">
													<c:set var="conc"
														value="/resources/modCommon/moduleimages/#{theme.name}/#{node.value.imagen}"></c:set>
													<c:set var="existeicon"
														value="#{viewSelectorBuilder.existFile(conc)}"></c:set>
													<h:graphicImage value="#{conc}" height="16"
														style="left:-1px; position: relative;"
														rendered="#{existeicon}" />
													<h:graphicImage
														value="/resources/modCommon/moduleimages/#{theme.name}/generic.png"
														height="16" style="left:-1px; position: relative;"
														rendered="#{not existeicon}" />

													<a:commandLink value="#{node.value.label}"
														status="funcSelectedStatus" limitToList="true"
														style="position: relative; top: -4px; left: 1px;"
														ajaxSingle="true" immediate="true" event="onclick"
														action="#{funcionalidadesManager.setSelectedFunctionality(node, treenode)}"
														reRender="settingsdiv, detailspanelheader, modalpanelsdiv">
													</a:commandLink>
												</div>
											</rich:treeNode>

											<rich:treeNode type="categoria" dragType="funcionalidad"
												acceptedTypes="funcionalidad"
												icon="/resources/funcionalidadesIcons/#{funcionalidadesManager.moduleByFuncionality(node.value).nombre}/#{node.value.imagen}"
												iconLeaf="/resources/funcionalidadesIcons/#{funcionalidadesManager.moduleByFuncionality(node.value).nombre}/#{node.value.imagen}">
												<a:commandLink value="#{node.value.label}"
													status="funcSelectedStatus" limitToList="true"
													ajaxSingle="true" immediate="true" event="onclick"
													action="#{funcionalidadesManager.setSelectedFunctionality(node, treenode)}"
													reRender="settingsdiv, detailspanelheader, modalpanelsdiv">
												</a:commandLink>
												<rich:dndParam name="label" type="drag"
													value="#{node.value.label}" />
												<rich:dndParam name="modulename" type="drag"
													value="#{funcionalidadesManager.moduleByFuncionality(node.value).nombre}" />
												<rich:dndParam name="iconname" type="drag"
													value="#{node.value.imagen}" />
											</rich:treeNode>

											<rich:treeNode type="funcionalidad" dragType="funcionalidad"
												icon="/resources/funcionalidadesIcons/#{funcionalidadesManager.moduleByFuncionality(node.value).nombre}/#{node.value.imagen}"
												iconLeaf="/resources/funcionalidadesIcons/#{funcionalidadesManager.moduleByFuncionality(node.value).nombre}/#{node.value.imagen}">
												<a:commandLink value="#{node.value.label}"
													status="funcSelectedStatus" limitToList="true"
													ajaxSingle="true" immediate="true" event="onclick"
													action="#{funcionalidadesManager.setSelectedFunctionality(node, treenode)}"
													reRender="settingsdiv, detailspanelheader, modalpanelsdiv">
												</a:commandLink>
												<rich:dndParam name="label" type="drag"
													value="#{node.value.label}" />
												<rich:dndParam name="modulename" type="drag"
													value="#{funcionalidadesManager.moduleByFuncionality(node.value).nombre}" />
												<rich:dndParam name="iconname" type="drag"
													value="#{node.value.imagen}" />
											</rich:treeNode>

										</rich:tree>
									</a:outputPanel>
								</a:region>
							</div>
						</rich:panel></td>

					<td style="vertical-align: top; width: 55%;"><a:region>
							<rich:panel bodyClass="functpanelbody" id="childfuncspanel">
								<f:facet name="header">
									<s:div id="detailspanelheader">
										<h:outputLabel value="#{messages.lbl_Modulos_conf}"
											rendered="#{funcionalidadesManager.selectedFunctionality == null}">
										</h:outputLabel>
										<s:div
											rendered="#{funcionalidadesManager.selectedFunctionality.toString().equals('modulo')}">
											<table cellpadding="0" cellspacing="0">
												<tr>
													<td><h:graphicImage
															value="/modCommons/modSelector/#{theme.name}/themes/#{theme.color}/images/icons/bg.png"
															height="16" width="16" /> <c:set var="conc"
															value="/resources/modCommon/moduleimages/#{theme.name}/#{funcionalidadesManager.selectedFunctionality.value.imagen}"></c:set>
														<c:set var="existeicon"
															value="#{viewSelectorBuilder.existFile(conc)}"></c:set> <h:graphicImage
															value="#{conc}" height="16"
															style="left:-16px; position: relative;"
															rendered="#{existeicon}" /> <h:graphicImage
															value="/resources/modCommon/moduleimages/#{theme.name}/generic.png"
															height="16" style="left:-16px; position: relative;"
															rendered="#{not existeicon}" /></td>
													<td><h:outputLabel
															style="left:-14px; position: relative;"
															value="#{funcionalidadesManager.selectedFunctionality.value.label}">
														</h:outputLabel></td>
												</tr>
											</table>
										</s:div>
										<s:div
											rendered="#{funcionalidadesManager.selectedFunctionality.toString().equals('categoria')}">
											<table cellpadding="0" cellspacing="0" width="100%">
												<tr>
													<td>
														<table cellpadding="0" cellspacing="0">
															<tr>
																<td><h:graphicImage height="16" width="16"
																		url="/resources/funcionalidadesIcons/#{funcionalidadesManager.moduleByFuncionality(funcionalidadesManager.selectedFunctionality.value).nombre}/#{funcionalidadesManager.selectedFunctionality.value.imagen}" />
																</td>
																<td><h:outputLabel
																		style="position: relative; left: 2px;"
																		value="#{funcionalidadesManager.selectedFunctionality.value.label}">
																	</h:outputLabel></td>
															</tr>
														</table>
													</td>
													<td align="right"><h:graphicImage
															title="#{messages.msg_modificar_modConfig}"
															style="border: 0px; cursor: pointer;"
															value="/resources/icons/default/acciones/modificar.png">
															<a:support event="onclick" limitToList="true"
																ajaxSingle="true"
																action="#{funcionalidadesManager.editCurrentCategory()}"
																reRender="modulo_modificar_cat_panel"
																oncomplete="javascript:Richfaces.showModalPanel('modulo_modificar_cat')">
															</a:support>
														</h:graphicImage></td>
												</tr>
											</table>
										</s:div>
										<s:div
											rendered="#{funcionalidadesManager.selectedFunctionality.toString().equals('funcionalidad')}">
											<table cellpadding="0" cellspacing="0" width="100%">
												<tr>
													<td>
														<table cellpadding="0" cellspacing="0">
															<tr>
																<td><h:graphicImage height="16" width="16"
																		url="/resources/funcionalidadesIcons/#{funcionalidadesManager.moduleByFuncionality(funcionalidadesManager.selectedFunctionality.value).nombre}/#{funcionalidadesManager.selectedFunctionality.value.imagen}" />
																</td>
																<td><h:outputLabel
																		style="position: relative; left: 2px;"
																		value="#{funcionalidadesManager.selectedFunctionality.value.label}">
																	</h:outputLabel></td>
															</tr>
														</table>
													</td>
													<td align="right"><h:graphicImage
															title="#{messages.msg_modificar_modConfig}"
															style="border: 0px; cursor: pointer;"
															value="/resources/icons/default/acciones/modificar.png">
															<a:support event="onclick" limitToList="true"
																ajaxSingle="true" reRender="modulo_agregar_func"
																timeout="2000"
																action="#{funcionalidadesManager.editCurrentFunctionality()}"
																oncomplete="javascript:Richfaces.showModalPanel('modulo_agregar_func')">
															</a:support>
														</h:graphicImage></td>
												</tr>
											</table>
										</s:div>

									</s:div>
								</f:facet>
								<a:status id="funcstatus2"
									onstart="document.body.style.cursor='wait'; Richfaces.showModalPanel('ajaxLoadingModalBox',{left:1, top:-15});"
									onstop="document.body.style.cursor='default'; Richfaces.hideModalPanel('ajaxLoadingModalBox');">
								</a:status>
								<a:status id="funcSelectedStatus" forceId="true"
									onstart="javascript:document.getElementById('funcionalidadesControllerForm3:settsdiv').style.display = 'none';
					  		   javascript:document.getElementById('funcionalidadesControllerForm3:loadingdiv').style.display = ''"
									onstop="javascript:document.getElementById('funcionalidadesControllerForm3:loadingdiv').style.display = 'none';
					  		  javascript:document.getElementById('funcionalidadesControllerForm3:settsdiv').style.display = ''">
									<f:facet name="start">
									</f:facet>
								</a:status>
								<s:div id="loadingdiv"
									style="text-align: center; width: 100%; display:none;">
									<br />
									<br />
									<h:graphicImage
										url="/resources/icons/default/acciones/loading_small.gif" />
									<br />
									<br />
									<br />
								</s:div>
								<s:div id="settsdiv">
									<s:div id="settingsdiv" style="display: inline;">
										<s:div
											rendered="#{funcionalidadesManager.selectedFunctionality == null}">
											<h:dataTable value="#{funcionalidadesManager.modulos()}"
												var="module"
												style="width:100%; text-align:left; border: 1px solid #d0d7e5; border-collapse:collapse;"
												cellspacing="0" cellpadding="0" border="1"
												rowClasses="dr-table-firstrow2">
												<h:column>
													<h:panelGrid columns="4" cellpadding="0" cellspacing="0">
														<h:graphicImage
															value="/modCommons/modSelector/#{theme.name}/themes/#{theme.color}/images/icons/bg.png"
															height="16" width="16" style="padding: 2px 2px 2px 2px" />

														<c:set var="conc"
															value="/resources/modCommon/moduleimages/#{theme.name}/#{module.imagen}"></c:set>
														<c:set var="existeicon"
															value="#{viewSelectorBuilder.existFile(conc)}"></c:set>
														<h:graphicImage value="#{conc}" height="16"
															style="left:-18px; position: relative;"
															rendered="#{existeicon}" />
														<h:graphicImage
															value="/resources/modCommon/moduleimages/#{theme.name}/generic.png"
															height="16" style="left:-18px; position: relative;"
															rendered="#{not existeicon}" />

														<a:commandLink ajaxSingle="true"
															reRender="settingsdiv, detailspanelheader"
															limitToList="true" value="#{module.label}"
															status="funcSelectedStatus"
															action="#{funcionalidadesManager.setSelectedFunctionality(module)}"
															style="margin-left: 0px; color: ##{theme.linkscolor}; left:-16px; position: relative;" />
													</h:panelGrid>
												</h:column>

											</h:dataTable>
										</s:div>
										<s:div
											rendered="#{funcionalidadesManager.selectedFunctionality.toString().equals('modulo')	and funcionalidadesManager.selectedFunctionality.value.contenedorIconos == true}"
											style="margin-left:3px; margin-right:3px;">
											<rich:spacer height="8" style="display: block;" />
											<h:dataTable value="#{funcionalidadesManager.modulosHijos()}"
												var="module"
												style="width:100%; text-align:left; border: 1px solid #d0d7e5; border-collapse:collapse;"
												cellspacing="0" cellpadding="0" border="1"
												rowClasses="dr-table-firstrow2">
												<f:facet name="header">
													<div style="background-color: ##{theme.headercolor}">#{messages.lbl_listadoSubmodulo_conf}</div>
												</f:facet>
												<h:column>
													<h:panelGrid columns="4" cellpadding="0" cellspacing="0">
														<h:graphicImage
															value="/modCommons/modSelector/#{theme.name}/themes/#{theme.color}/images/icons/bg.png"
															height="16" width="16" style="padding: 2px 2px 2px 2px" />

														<c:set var="conc"
															value="/resources/modCommon/moduleimages/#{theme.name}/#{module.imagen}"></c:set>
														<c:set var="existeicon"
															value="#{viewSelectorBuilder.existFile(conc)}"></c:set>
														<h:graphicImage value="#{conc}" height="16"
															style="left:-18px; position: relative;"
															rendered="#{existeicon}" />
														<h:graphicImage
															value="/resources/modCommon/moduleimages/#{theme.name}/generic.png"
															height="16" style="left:-18px; position: relative;"
															rendered="#{not existeicon}" />

														<a:commandLink ajaxSingle="true"
															reRender="settingsdiv, detailspanelheader"
															limitToList="true" value="#{module.label}"
															status="funcSelectedStatus"
															action="#{funcionalidadesManager.setSelectedFunctionality(module)}"
															style="margin-left: 0px; color: ##{theme.linkscolor}; left:-16px; position: relative;" />
													</h:panelGrid>
												</h:column>
											</h:dataTable>
											<s:div
												style="border-left: 1px solid #d0d7e5;
									  border-right: 1px solid #d0d7e5;
									  border-bottom: 1px solid #d0d7e5;"
												rendered="#{funcionalidadesManager.modulosHijos().size() == 0}">
												<rich:spacer height="10" style="display:block" />
												<h:outputLabel
													value="#{messages.msg_NoExisteInformacion_conf}"
													style="margin-left:7px;" />
												<rich:spacer height="5" style="display:block" />
											</s:div>
										</s:div>
										<s:div
											rendered="#{funcionalidadesManager.selectedFunctionality.toString().equals('modulo') or funcionalidadesManager.selectedFunctionality.toString().equals('categoria')}">
											<table style="width: 100%; vertical-align: top;">
												<tr valign="top">
													<td><rich:spacer height="5" style="display:block;"></rich:spacer>

														<table cellpadding="0" cellspacing="1" width="100%">
															<tr>
																<td align="right" width="100%"><h:graphicImage
																		height="12" width="12" style="cursor:pointer;"
																		value="/resources/icons/default/acciones/adicionar.png">
																		<a:support event="onclick" limitToList="true"
																			ajaxSingle="true" reRender="modulo_agregar_cat"
																			oncomplete="javascript:Richfaces.showModalPanel('modulo_agregar_cat')">
																		</a:support>
																	</h:graphicImage></td>
																<td align="right" style="white-space: nowrap;"><h:outputLink
																		value="#"
																		style="margin-left:0px;margin-bottom:4px;margin-top:2px;">
												#{messages.btn_Adicionarcategoria_conf}
												<a:support event="onclick" limitToList="true"
																			ajaxSingle="true" reRender="modulo_agregar_cat"
																			oncomplete="javascript:Richfaces.showModalPanel('modulo_agregar_cat')">
																		</a:support>
																	</h:outputLink></td>
																<td align="right" style="white-space: nowrap;"><s:div
																		rendered="#{funcionalidadesManager.moduleChildCategories.size() != 0 or funcionalidadesManager.moduleChildFuncionalidades.size() != 0}">
																		<table cellpadding="0" cellspacing="1">
																			<tr>
																				<td><h:graphicImage height="12" width="12"
																						rendered="#{not funcionalidadesManager.editingOrders}"
																						value="/resources/icons/default/acciones/modificar.png"
																						style="margin-left:5px; cursor:pointer;">
																						<a:support event="onclick" limitToList="true"
																							ajaxSingle="true" reRender="childfuncspanel">
																							<a:actionparam
																								assignTo="#{funcionalidadesManager.editingOrders}"
																								value="#{not funcionalidadesManager.editingOrders}" />
																						</a:support>
																					</h:graphicImage></td>
																				<td><h:outputLink value="#"
																						rendered="#{not funcionalidadesManager.editingOrders}"
																						style="margin-left:0px;margin-bottom:4px;margin-top:2px;">
														#{messages.btn_ModificarOrden_conf}
														<a:support event="onclick" limitToList="true"
																							ajaxSingle="true" reRender="childfuncspanel">
																							<a:actionparam
																								assignTo="#{funcionalidadesManager.editingOrders}"
																								value="#{not funcionalidadesManager.editingOrders}" />
																						</a:support>
																					</h:outputLink> <h:panelGrid cellpadding="0" cellspacing="0"
																						columns="4"
																						rendered="#{funcionalidadesManager.editingOrders}">
																						<h:graphicImage
																							value="/resources/modConfiguracion/visible.png"
																							width="12" height="12"
																							style="border:0px; cursor: pointer; margin-left:5px;"
																							title="#{messages.btn_aceptar_conf}">
																							<a:support event="onclick" limitToList="true"
																								action="#{funcionalidadesManager.salvarOrden()}"
																								reRender="childfuncspanel">
																								<a:actionparam
																									assignTo="#{funcionalidadesManager.editingOrders}"
																									value="#{not funcionalidadesManager.editingOrders}" />
																							</a:support>
																						</h:graphicImage>
																						<h:outputLink value="#"
																							title="#{messages.btn_aceptar_conf}"
																							style="margin-left:2px;margin-bottom:4px;margin-top:2px;">
															#{messages.btn_aceptar_conf}
															<a:support event="onclick" limitToList="true"
																								action="#{funcionalidadesManager.salvarOrden()}"
																								reRender="childfuncspanel">
																								<a:actionparam
																									assignTo="#{funcionalidadesManager.editingOrders}"
																									value="#{not funcionalidadesManager.editingOrders}" />
																							</a:support>
																						</h:outputLink>
																						<h:graphicImage
																							value="/resources/modConfiguracion/not-visible.png"
																							width="12" height="12"
																							style="border:0px; margin-left:4px; cursor: pointer;"
																							title="#{messages.btn_cancelar_conf}">
																							<a:support event="onclick" limitToList="true"
																								ajaxSingle="true" reRender="childfuncspanel">
																								<a:actionparam
																									assignTo="#{funcionalidadesManager.editingOrders}"
																									value="#{not funcionalidadesManager.editingOrders}" />
																							</a:support>
																						</h:graphicImage>
																						<h:outputLink value="#"
																							title="#{messages.btn_cancelar_conf}"
																							style="margin-left:2px;margin-bottom:4px;margin-top:2px;">
															#{messages.btn_cancelar_conf}
															<a:support event="onclick" limitToList="true"
																								ajaxSingle="true" reRender="childfuncspanel">
																								<a:actionparam
																									assignTo="#{funcionalidadesManager.editingOrders}"
																									value="#{not funcionalidadesManager.editingOrders}" />
																							</a:support>
																						</h:outputLink>
																					</h:panelGrid></td>
																			</tr>
																		</table>
																	</s:div></td>

															</tr>
														</table> <s:div id="categoriastable">
															<h:dataTable
																value="#{funcionalidadesManager.moduleChildCategories}"
																var="cat" border="1"
																style="width:100%; text-align:left; border: 1px solid #d0d7e5; border-collapse:collapse;"
																cellspacing="0" cellpadding="0"
																rowClasses="dr-table-firstrow2"
																columnClasses="strech, nostrech, nostrech">
																<f:facet name="header">
																	<div style="background-color: ##{theme.headercolor}">#{messages.lbl_listadoDeCategorias_conf}</div>
																</f:facet>
																<h:column
																	rendered="#{funcionalidadesManager.moduleChildCategories.size() != 0}">
																	<f:facet name="header">
																		<div style="background-color: ##{theme.headercolor}">#{messages.lbl_nombre_conf}</div>
																	</f:facet>
																	<table cellpadding="0" cellspacing="0" border="0"
																		style="text-align: left;">
																		<tr>
																			<td><h:graphicImage height="16" width="16"
																					url="/resources/funcionalidadesIcons/#{funcionalidadesManager.moduleByFuncionality(cat).nombre}/#{cat.imagen}" />
																			</td>
																			<td><a:commandLink ajaxSingle="true"
																					reRender="settingsdiv, detailspanelheader"
																					limitToList="true" value="#{cat.label}"
																					status="funcSelectedStatus"
																					action="#{funcionalidadesManager.setSelectedCategory(cat)}"
																					style="margin-left: 2px; color: ##{theme.linkscolor};" />
																			</td>
																		</tr>
																	</table>
																</h:column>
																<h:column
																	rendered="#{funcionalidadesManager.editingOrders}">
																	<f:facet name="header">
																		<div style="background-color: ##{theme.headercolor}">#{messages.lbl_Orden_conf}</div>
																	</f:facet>
																	<h:inputText id="odenCat" value="#{cat.orden}"
																		style="width: 30px; text-align:right;"/>
																	<rich:message for="odenCat" showDetail="false"
																		tooltip="true" style="color:red;cursor:pointer;">
																		<f:facet name="errorMarker">
																			<h:outputText value="*"
																				title="#{facesMessages.getCurrentMessagesForControl('odenCat').get(0).getDetail()}" />
																		</f:facet>
																	</rich:message>
																</h:column>
																<h:column
																	rendered="#{funcionalidadesManager.moduleChildCategories.size() != 0}">
																	<f:facet name="header">
																		<div style="background-color: ##{theme.headercolor}">
																			<span style="margin-left: 2px; margin-right: 2px;">#{messages.lbl_vis_modConfig}</span>
																		</div>
																	</f:facet>
																	<div align="center">
																		<a:commandLink status="funcstatus2"
																			rendered="#{cat.eliminado != true}" ajaxSingle="true"
																			limitToList="true" reRender="categoriastable"
																			action="#{funcionalidadesManager.changeFuncVisibility(cat.id.toString())}">
																			<h:graphicImage
																				value="/resources/modConfiguracion/visible.png"
																				width="14" height="14" style="border:0px;"
																				title="#{messages.lbl_cambiarVisibilidad_conf}" />
																		</a:commandLink>
																		<a:commandLink status="funcstatus2" limitToList="true"
																			reRender="categoriastable"
																			rendered="#{cat.eliminado == true}" ajaxSingle="true"
																			action="#{funcionalidadesManager.changeFuncVisibility(cat.id.toString())}">
																			<h:graphicImage
																				value="/resources/modConfiguracion/not-visible.png"
																				width="14" height="14" style="border:0px;"
																				title="#{messages.lbl_cambiarVisibilidad_conf}" />
																		</a:commandLink>
																	</div>
																</h:column>
																<h:column
																	rendered="#{funcionalidadesManager.moduleChildCategories.size() != 0}">
																	<f:facet name="header">
																		<div style="background-color: ##{theme.headercolor}">
																			<span style="margin-left: 2px; margin-right: 2px;">#{messages.msg_eliminar_modConfig}</span>
																		</div>
																	</f:facet>
																	<div align="center">
																		<a:commandLink rendered="true"
																			action="#{funcionalidadesManager.setFunctIdToRemove(cat.id.toString()) }"
																			oncomplete="Richfaces.showModalPanel('eliminar_categoria_panel', {entityname: 'categoría' } )"
																			view="/modConfiguracion/funcionalidades/funcionalidades.xhtml">
																			<h:graphicImage style="border:0px; cursor: pointer"
																				title="#{messages.msg_eliminar_modConfig}"
																				url="/resources/icons/default/acciones/eliminar.png">
																			</h:graphicImage>
																		</a:commandLink>
																	</div>
																</h:column>
															</h:dataTable>
															<s:div
																style="border-left: 1px solid #d0d7e5;
													  border-right: 1px solid #d0d7e5;
													  border-bottom: 1px solid #d0d7e5;"
																rendered="#{funcionalidadesManager.moduleChildCategories.size() == 0}">
																<rich:spacer height="10" style="display:block" />
																<h:outputLabel
																	value="#{messages.msg_NoExisteInformacion_conf}"
																	style="margin-left:7px;" />
																<rich:spacer height="5" style="display:block" />
															</s:div>
														</s:div></td>
												</tr>

												<tr valign="top">
													<td align="" style="white-space: nowrap;"><rich:spacer
															height="5" style="display:block;"></rich:spacer>
														<div align="right">
															<h:panelGrid columns="2" cellpadding="0" cellspacing="1">
																<h:graphicImage height="12" width="12"
																	style="cursor:pointer;"
																	value="/resources/icons/default/acciones/adicionar.png">
																	<a:support event="onclick" limitToList="true"
																		ajaxSingle="true" reRender="modulo_agregar_func"
																		timeout="8000"
																		action="#{funcionalidadesManager.insertNewFunctionality()}"
																		oncomplete="javascript:Richfaces.showModalPanel('modulo_agregar_func')">
																	</a:support>
																</h:graphicImage>
																<h:outputLink value="#"
																	style="margin-left:0px;margin-bottom:4px;margin-top:2px;">
											#{messages.lbl_Adicionarfuncionalidad_conf}
											<a:support event="onclick" limitToList="true"
																		ajaxSingle="true" reRender="modulo_agregar_func"
																		timeout="8000"
																		action="#{funcionalidadesManager.insertNewFunctionality()}"
																		oncomplete="javascript:Richfaces.showModalPanel('modulo_agregar_func')">
																	</a:support>

																</h:outputLink>
															</h:panelGrid>
														</div> <s:div id="funcstable">
															<h:dataTable
																value="#{funcionalidadesManager.moduleChildFuncionalidades}"
																var="func" border="1"
																style="width:100%; text-align:left; border: 1px solid #d0d7e5; border-collapse:collapse;"
																cellspacing="0" cellpadding="0"
																rowClasses="dr-table-firstrow2"
																columnClasses="strech, nostrech">
																<f:facet name="header">
																	<div style="background-color: ##{theme.headercolor}">#{messages.lbl_listadoFuncionalidades_conf}</div>
																</f:facet>
																<h:column
																	rendered="#{funcionalidadesManager.moduleChildFuncionalidades.size() != 0}">
																	<f:facet name="header">
																		<div style="background-color: ##{theme.headercolor}">#{messages.lbl_nombre_conf}</div>
																	</f:facet>
																	<table cellpadding="0" cellspacing="0" border="0"
																		style="text-align: left;">
																		<tr>
																			<td><h:graphicImage height="16" width="16"
																					url="/resources/funcionalidadesIcons/#{funcionalidadesManager.moduleByFuncionality(func).nombre}/#{func.imagen}" />
																			</td>
																			<td><h:outputLabel value="#{func.label}"
																					style="cursor:pointer; padding-left:3px;"
																					rendered="false">
																				</h:outputLabel> <a:commandLink ajaxSingle="true"
																					reRender="settingsdiv, detailspanelheader"
																					limitToList="true" value="#{func.label}"
																					status="funcSelectedStatus"
																					action="#{funcionalidadesManager.setSelectedFunctionality(func, 0)}"
																					style="margin-left: 2px; color: ##{theme.linkscolor};" />
																			</td>
																		</tr>
																	</table>

																</h:column>
																<h:column
																	rendered="#{funcionalidadesManager.editingOrders}">
																	<f:facet name="header">
																		<div style="background-color: ##{theme.headercolor}">#{messages.lbl_Orden_conf}</div>
																	</f:facet>
																	<h:inputText value="#{func.orden}" id="ordenFunc"
																		style="width: 30px; text-align:right;" />
																	<rich:message for="ordenFunc" showDetail="false"
																		tooltip="true" style="color:red;cursor:pointer;">
																		<f:facet name="errorMarker">
																			<h:outputText value="*"
																				title="#{facesMessages.getCurrentMessagesForControl('ordenFunc').get(0).getDetail()}" />
																		</f:facet>
																	</rich:message>
																</h:column>
																<h:column
																	rendered="#{funcionalidadesManager.moduleChildFuncionalidades.size() != 0}">
																	<f:facet name="header">
																		<div style="background-color: ##{theme.headercolor}">
																			<span style="margin-left: 2px; margin-right: 2px;">#{messages.lbl_vis_modConfig}</span>
																		</div>
																	</f:facet>
																	<div align="center">
																		<a:commandLink status="funcstatus2"
																			rendered="#{func.eliminado != true}"
																			ajaxSingle="true" limitToList="true"
																			reRender="funcstable"
																			action="#{funcionalidadesManager.changeFuncVisibility(func.id.toString())}">
																			<h:graphicImage
																				value="/resources/modConfiguracion/visible.png"
																				width="14" height="14" style="border:0px;"
																				title="#{messages.lbl_cambiarVisibilidad_conf}" />
																		</a:commandLink>
																		<a:commandLink status="funcstatus2" limitToList="true"
																			reRender="funcstable"
																			rendered="#{func.eliminado == true}"
																			ajaxSingle="true"
																			action="#{funcionalidadesManager.changeFuncVisibility(func.id.toString())}">
																			<h:graphicImage
																				value="/resources/modConfiguracion/not-visible.png"
																				width="14" height="14"
																				style="border:0px; width : 14px;"
																				title="#{messages.lbl_cambiarVisibilidad_conf}" />
																		</a:commandLink>
																	</div>
																</h:column>
																<h:column
																	rendered="#{funcionalidadesManager.moduleChildFuncionalidades.size() != 0}">
																	<f:facet name="header">
																		<div style="background-color: ##{theme.headercolor}">
																			<span style="margin-left: 2px; margin-right: 2px;">#{messages.msg_eliminar_modConfig}</span>
																		</div>
																	</f:facet>

																	<div align="center">
																		<a:commandLink rendered="true"
																			id="eliminarfuncionalidadCommandLink"
																			action="#{funcionalidadesManager.setFunctIdToRemove(func.id.toString()) }"
																			oncomplete="Richfaces.showModalPanel('eliminar_funcionalidad_panel', {entityname: 'categoría' } )"
																			view="/modConfiguracion/funcionalidades/funcionalidades.xhtml">
																			<h:graphicImage style="border:0px; cursor: pointer"
																				title="#{messages.msg_eliminar_modConfig}"
																				url="/resources/icons/default/acciones/eliminar.png">
																			</h:graphicImage>
																		</a:commandLink>
																	</div>

																</h:column>
															</h:dataTable>
															<s:div
																style="border-left: 1px solid #d0d7e5;
												  border-right: 1px solid #d0d7e5;
												  border-bottom: 1px solid #d0d7e5;"
																rendered="#{funcionalidadesManager.moduleChildFuncionalidades.size() == 0}">
																<rich:spacer height="10" style="display:block" />
																<h:outputLabel
																	value="#{messages.msg_NoExisteInformacion_conf}"
																	style="margin-left:7px;" />
																<rich:spacer height="5" style="display:block" />
															</s:div>
														</s:div></td>
												</tr>
											</table>
										</s:div>
										<s:div
											rendered="#{funcionalidadesManager.selectedFunctionality.toString().equals('funcionalidad')}">
											<table cellpadding="0px" cellspacing="0px" border="0px"
												id="simplesearch">
												<tr>
													<td style="height: 11px;" colspan="6"></td>
												</tr>
												<tr style="vertical-align: top;">
													<td style="width: 7px;"></td>
													<td style="vertical-align: top;">
														#{messages.lbl_nombre_conf}: <rich:spacer height="8"
															style="display:block"></rich:spacer>
														#{messages.lbl_Url_conf}:

													</td>
													<td style="width: 6px"></td>
													<td><h:outputLabel styleClass="dataText"
															value="#{funcionalidadesManager.selectedFunctionality.value.label}"
															style="position:relative; left:-1px;">
														</h:outputLabel> <rich:spacer height="8" style="display:block"></rich:spacer>
														<h:outputLabel styleClass="dataText"
															value="#{funcionalidadesManager.selectedFunctionality.value.url}"></h:outputLabel>
													</td>
													<td style="width: 25px"></td>
													<td style="vertical-align: bottom;"></td>
												</tr>
												<tr>
													<td style="width: 7px;"></td>
													<td align="left" colspan="5"><s:div rendered="false">
															<rich:spacer height="8" style="display:block"></rich:spacer>
															<table cellpadding="0" cellspacing="0">
																<tr style="vertical-align: middle;">
																	<td><h:graphicImage value=""
																			url="/resources/modConfiguracion/funcionalidades.png" /></td>
																	<td><a:commandLink
																			value="#{messages.lbl_ConvertirEnCategoria_conf}"
																			style="position: relative; left: 2px;"
																			action="#{funcionalidadesManager.convertToCategory()}"
																			oncomplete="" /></td>
																</tr>
															</table>
															<br />
														</s:div></td>
												</tr>
											</table>

											<br />
										</s:div>
									</s:div>
								</s:div>

							</rich:panel>
							<s:div style="text-align: right;">
								<s:button view="/modCommons/modHome/home.gehos"
									value="#{messages.lbl_Salir_conf}" style="margin-right:0px"
									rendered="#{not identificadorManager.editing}">
									<f:param name="idFuncionalidad"
										value="#{activeModule.activeModule.id}" />
									<f:param name="idancestors"
										value="#{activeModule.activeModule.id}a" />
									<f:param name="moduleName"
										value="#{activeModule.activeModuleName}" />
								</s:button>
							</s:div>
						</a:region></td>
				</tr>
			</table>

		</h:form>


		<a:region>
			<a:form>
				<a:jsFunction name="updateNode" status="funcstatus"
					action="#{funcionalidadesManager.treeBuilder.updateNode(funcionalidadesManager.selectedTreenode)}"
					reRender="functree, childfuncspanel">
				</a:jsFunction>
			</a:form>
		</a:region>



		<s:div id="modalpanelsdiv">
			<ui:include
				src="/modConfiguracion/funcionalidades/modalpanels/modulo_agregar_categoria.xhtml" />

			<ui:include
				src="/modConfiguracion/funcionalidades/modalpanels/modulo_modificar_categoria.xhtml" />

			<ui:include
				src="/modConfiguracion/funcionalidades/modalpanels/modulo_agregar_funcionalidad.xhtml" />

			<ui:include
				src="/modConfiguracion/funcionalidades/modalpanels/confirmar_eliminar_func.xhtml" />
				<ui:include
				src="/modConfiguracion/funcionalidades/modalpanels/confirmar_eliminar_cat.xhtml" />

		</s:div>

		<rich:modalPanel id="ajaxLoadingModalBox" minHeight="10" minWidth="10"
			height="10" width="10" zindex="2000">
			<s:div rendered="false">
				<img id="favsloadingdiv"
					src="#{facesContext.externalContext.requestContextPath}/resources/icons/default/acciones/loading_small.gif"
					style="position: absolute; top: 0px; left: 0px;" />
			</s:div>
		</rich:modalPanel>


	</ui:define>
</ui:composition>
